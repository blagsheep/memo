<script>
  mapboxgl.accessToken = 'pk.eyJ1IjoibWFyY3VzLWZvcmNobmVyIiwiYSI6ImNreDA1MHI2czBkMXUycXFsd2JqcWVtZWoifQ.LUGuOxwCmOtjcghKK-dDRg';
  const map = new mapboxgl.Map({
  container: 'map', 
  style: 'mapbox://styles/mapbox/streets-v11', 
  center: [<%=embeds[0].metadata["longitude"]%>, <%=embeds[0].metadata["latitude"]%>], 
  zoom: 9 // starting zoom
  });

<% embeds.each do |embedded_image| %>
  <% if !embedded_image.metadata["longitude"].nil? %>     
    const marker<%=embedded_image.id%> = new mapboxgl.Marker()
    .setLngLat([<%=embedded_image.metadata["longitude"]%>, <%=embedded_image.metadata["latitude"]%>])
    .addTo(map);
  <% end %>
<% end %>
</script>

<style>
  #map { width: 100%; height: 300px; }
</style>
